<!-- Main Application Container -->
<div class="container">
  
  <header class="header">
    <h1>Natural Language Query</h1>
    <p>Ask a question about your treasury payments and see the data.</p>
  </header>

  <!-- Query Input Form -->
  <form (ngSubmit)="onSubmit()" class="query-form">
    <div class="form-group">
      <textarea 
        class="form-input"
        [(ngModel)]="currentQuery" 
        name="query"
        placeholder="e.g., Show me the payment trend for failed USD payments over the last 30 days"
        [disabled]="isLoading"
        rows="2"
        (input)="autoGrowTextarea($event)"
      ></textarea>
      
      <button type="submit" class="form-button" [disabled]="isLoading">
        <span *ngIf="!isLoading">Ask</span>
        <span *ngIf="isLoading" class="loader"></span>
      </button>
    </div>
  </form>

  <!-- Loading Spinner (Full width) -->
  <div *ngIf="isLoading && !apiResponse" class="loading-full">
    <div class="loader-full"></div>
    <p>Thinking...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    <strong>Error:</strong> {{ errorMessage }}
  </div>

  <!-- CHART SWITCHER BUTTONS - REMOVED -->

  <!-- 
    Dynamic Visualization Area 
    FIX: Simplified to only show the table
  -->
  <div *ngIf="apiResponse" class="chart-area">

    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th *ngFor="let header of tableHeaders">{{ header }}</th>
          </tr>
        </thead>
        <tbody>
          <!-- Use the original data for the table -->
          <tr *ngFor="let row of apiResponse.data">
            <td *ngFor="let header of tableHeaders">{{ row[header] }}</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>